node('master') {
//    checkout scm

//   def trace = load 'pipelineTrace.groovy'
//    def logs = load 'logFile.groovy'

    def WORKSPACE = "${env.WORKSPACE}"

//    def myEnv = config.loadConfig()
//	echo "ArtifactFolder== ${myEnv.ArtifactFolder}"           

    trace.startStage(WORKSPACE, "${env.BUILD_NUMBER}", "${env.GIT_BRANCH}", 'Pipeline')

    load 'pipeline/stages/_MS_Build_Stage'
    load 'pipeline/stages/_MS_Coverage_Stage'
    load 'pipeline/stages/_MS_Coverage_Stage'
    load 'pipeline/stages/_MS_Install_Stage'
    load 'pipeline/stages/_MS_ArtifactUpload_Stage'
    load 'pipeline/stages/_MS_DeployToDev_Stage'
    load 'pipeline/stages/_MS_DeployToTest_Stage'
}

def clean() {
    bat '"%powershell%" -ExecutionPolicy ByPass -File %delete_folder% -DIRECTORY %ARTIFACT_PATH%'
    bat '"%powershell%" -ExecutionPolicy ByPass -File %delete_folder% -DIRECTORY %PACKAGE_PATH%'
}

